> 组件是指比较小的功能块，这些组件不需要多少组件间通信，没什么依赖，也就不需要做什么其他处理，面向对象就能搞定。多个项目使用同一个组件明显可以让代码复用，出了问题也好集中的维护起来，组件化和模块化有所不同，组件化的诉求是**好用**，而模块化诉求的是**解耦**。这里将使用**CocoaPods**来对代码组件化管理。同时对 **公共UI**、**底层的VC**、**底层网络请求**、**数据缓存**、**工具方法**、**js和native交互** **模块间的路由类** 及 **独立的业务模块** 等进行组件化。



### 一、整体框架图

![基础组件结构](http://7xqhx8.com1.z0.glb.clouddn.com/%E7%BB%84%E4%BB%B6%E5%8C%96%E7%BB%93%E6%9E%84.png) 

各个组件做为pod，将该组件的基本信息提交到私有仓库specs中，业务层只需使用Cocoapods，从私有仓库specs拿到pod的信息，然后获取对应组件的源码。



- [x] [midea-specs](http://172.16.10.165/midea-common/midea-specs)：这里保存的是各个组件化代码的podsepc文件（即各个组建的说明文件），而非组件化的具体代码地址。（毛克斌、邓立兵）

      ​

- [ ] [midea-common-ui](http://172.16.10.165/midea-common/midea-common-ui) : 所有的UI相关的组件代码都放在该地址，下面分为多个子模块。（林荣俊）

      ​

- [x] [midea-common-base](http://172.16.10.165/midea-common/midea-common-base)：基础组件，MVP设计模式。（毛克斌、邓立兵）

      ​

- [ ] [midea-common-tools](http://172.16.10.165/midea-common/midea-common-tools)：工具组件。（毛克斌）

      ​

- [x] [midea-common-datacache](http://172.16.10.165/midea-common/midea-common-datacache)：数据缓存管理组件，底层依赖WXDB。（马一方）

      ​

- [x] [midea-common-adddevice](http://172.16.10.165/midea-common/midea-common-adddevice)：配网模块。实现了添加设备功能，思路按照Cordova，一个配网模式对应一个类处理，该组件包含两个子模块：逻辑模块、UI模块。（李燕强、邓立兵）

      ​

- [x] [midea-common-log](http://172.16.10.165/midea-common/midea-common-log)：日志组件，对DDLog的一次封装。（李燕强）

      ​

- [x] [midea-common-network](http://172.16.10.165/midea-common/midea-common-network)：网络请求组件，包含网络缓存及多环境切换的中间层。（陈文豪、邓立兵）

      ​

- [ ] [midea-common-jsbridge](http://172.16.10.165/midea-common/midea-common-jsbridge)：js和native交互组件，组件思路依照Cordova模式。（杜露阳、马一方）

      ​


- [ ] [midea-common-pluginmanager](http://172.16.10.165/midea-common/midea-common-pluginmanager)：下载插件、更新插件等功能。（杜露阳)

      ​

- [x] [midea-common-touchid](http://172.16.10.165/midea-common/midea-common-touchid)：TouchID功能组件。支持验证失败后，指定次数输入密码再次弹出TouchID/FaceID验证界面；支持强制弹出TouchID/FaceID验证界面。（邓立兵)



### 二、一些组件的说明

#### **1、midea-common-base** 

> 美的智慧iOS组件代码的基础组件。使用标准的MVP模式，使得大量的业务代码，数据获取及解析成对象模型的代码从以前的Controller层迁移到Presenter层、Repository层。分层明显、并且更加方便进行单元测试。

![基础组件对应的UML模型图](http://7xqhx8.com1.z0.glb.clouddn.com/midea-common-base%E4%B8%ADMVP%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90.png)  



#### 2、midea-common-adddevice

> 美的智慧iOS组件代码的配网模块。实现了添加设备功能，思路按照Cordova，一个配网模式对应一个类处理，该组件包含两个子模块：逻辑模块、UI模块。

![adddevice-uml](http://7xqhx8.com1.z0.glb.clouddn.com/adddevice-uml.png)



### 三、快速使用：

```ruby
# 项目的Podfile文件
platform :ios, ‘8.0’

# pod都需要做成动态库framework的形式存在
use_frameworks!

source 'https://github.com/CocoaPods/Specs.git'                   # 官方库地址
source 'http://172.16.10.165/midea-common/midea-specs.git'        # 私有库地址

# 这个地方是在pod install/update之前执行, 告诉这个pod工程是支持静态库的
pre_install do |installer|
    # workaround for https://github.com/CocoaPods/CocoaPods/issues/3289
    Pod::Installer::Xcode::TargetValidator.send(:define_method, :verify_no_static_framework_transitive_dependencies) {}
end

target '美智' do
    pod 'midea-common-ui'
    pod 'midea-common-datacache'
    pod 'midea-common-base'
    pod 'midea-common-tools'
    pod 'midea-common-jsbridge'
    pod 'midea-common-pluginmanager'
    pod 'midea-common-log'
    pod 'midea-common-adddevice'
    pod 'midea-common-network'
end
```

### 四、一些问题

有任何问题请联系我们：kebin.mao@midea.com、libing.deng@midea.com